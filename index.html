<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>APZOK 2D House Plan Designer</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="app-shell">

<div class="toolbar">
    <button class="tool-btn" data-tool="select" aria-label="Select">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_e8cd6441615c4fd39976a3812469b223.svg" alt="">
        <span class="tool-label">Select</span>
    </button>
    <button class="tool-btn" data-tool="wall" aria-label="Wall">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_38c6c46a65fd49a783dfbfd974740b0a.svg" alt="">
        <span class="tool-label">Wall</span>
    </button>
    <button class="tool-btn" data-tool="pan" aria-label="Pan">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_7fd823218d7b425593c311435c84c9bf.svg" alt="">
        <span class="tool-label">Pan</span>
    </button>
    <button class="tool-btn" data-tool="door" aria-label="Door">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_735e93c7dd2a4ef9969fb3bf1094e1b7.svg" alt="">
        <span class="tool-label">Door</span>
    </button>

    <!-- NEW â€” Door Type Dropdown -->
    <select id="doorType">
        <option value="normal">Normal Door (3ft)</option>
        <option value="main">Main Door (3.5ft)</option>
        <option value="bathroom">Bathroom Door (2.5ft)</option>
    </select>

    <button class="tool-btn" data-tool="window" aria-label="Window">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_0a3b507cf3fc427eaab066301a920e5c.svg" alt="">
        <span class="tool-label">Window</span>
    </button>
    <button class="tool-btn" data-tool="staircase" aria-label="Staircase">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_0f8bb41d89fe42488e1352df56340e45.svg" alt="">
        <span class="tool-label">Staircase</span>
    </button>
    <button class="tool-btn" data-tool="furniture" aria-label="Furniture">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_7ad998836ddb4a5ead990a30f61fda01.svg" alt="">
        <span class="tool-label">Furniture</span>
    </button>
    <button class="tool-btn" data-tool="floor" aria-label="Floor Fill">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_3c3ccac3849f432ab3f23ea24547af8c.svg" alt="">
        <span class="tool-label">Floor Fill</span>
    </button>
    <button class="tool-btn" data-tool="erase" aria-label="Erase">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_e9f15f1981cc43afbf920fdbc9bda6ba.svg" alt="">
        <span class="tool-label">Erase</span>
    </button>
    <button class="tool-btn" data-tool="dimension" aria-label="Dimension">
        <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_30f8437bfae148a38aca059207dc1ce2.svg" alt="">
        <span class="tool-label">Dimension</span>
    </button>
    <button class="tool-btn" data-tool="text" aria-label="Text">
        <span class="tool-icon text-icon">T</span>
        <span class="tool-label">Text</span>
    </button>

    <div class="transform-menu">
        <button id="rotateLeft" class="tool-btn secondary-btn" type="button" aria-label="Rotate Left">
            <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_74c75a751d214630a1839c167822df96.svg" alt="">
            <span class="tool-label">Rotate Left</span>
        </button>
        <button id="rotateRight" class="tool-btn secondary-btn" type="button" aria-label="Rotate Right">
            <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_74c75a751d214630a1839c167822df96.svg" alt="">
            <span class="tool-label">Rotate Right</span>
        </button>
        <button id="flipHorizontal" class="tool-btn secondary-btn" type="button" aria-label="Flip Horizontal">
            <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_b6a1fcb25d8743448091bf5d741f9eb1.svg" alt="">
            <span class="tool-label">Flip Horizontal</span>
        </button>
        <button id="flipVertical" class="tool-btn secondary-btn" type="button" aria-label="Flip Vertical">
            <img class="tool-icon" src="https://static.wixstatic.com/shapes/602ad4_590fe3b2279c4af9871b4cd3575104e4.svg" alt="">
            <span class="tool-label">Flip Vertical</span>
        </button>
    </div>

    <div class="view-menu">
        <span class="transform-title">Zoom</span>
        <button id="zoomOut" class="tool-btn secondary-btn" type="button" aria-label="Zoom Out">
            <span class="tool-icon text-icon">âˆ’</span>
            <span class="tool-label">Zoom Out</span>
        </button>
        <button id="zoomIn" class="tool-btn secondary-btn" type="button" aria-label="Zoom In">
            <span class="tool-icon text-icon">+</span>
            <span class="tool-label">Zoom In</span>
        </button>
    </div>

    <div class="project-menu">
        <button id="saveProject" class="tool-btn secondary-btn" type="button" aria-label="Save Project">
            <span class="tool-icon text-icon">ðŸ’¾</span>
            <span class="tool-label">Save Project</span>
        </button>
        <button id="uploadProject" class="tool-btn secondary-btn" type="button" aria-label="Upload Project">
            <span class="tool-icon text-icon">â¤´</span>
            <span class="tool-label">Upload Project</span>
        </button>
        <input id="projectFileInput" class="hidden" type="file" accept=".paz" aria-label="Upload .paz project file">
    </div>

    <div class="toolbar-spacer"></div>
    <button id="toggle3DView" class="tool-btn secondary-btn" type="button" aria-label="Toggle 3D View">
        <span class="tool-icon text-icon">3D</span>
        <span class="tool-label">Toggle 3D View</span>
    </button>

</div>

<div class="properties">
    <div class="property-group" data-contexts="wall">
        <label>Wall Thickness</label>
        <div class="property-input-row">
            <input id="wallThicknessFeet" type="number" value="0"> ft
            <input id="wallThicknessInches" type="number" value="6"> in
        </div>
    </div>

    <div class="property-group" data-contexts="wall,door,window,staircase,furniture,dimension,select,erase,pan">
        <label>Line Width</label>
        <input id="lineWidth" type="number" value="2">
    </div>

    <div class="property-group" data-contexts="wall,door,window,staircase,furniture,dimension,select,erase,pan">
        <label>Line Color</label>
        <div class="property-input-row">
            <input id="lineColor" type="color" value="#000000">
            <span id="lineColorPreview"></span>
        </div>
    </div>

    <div class="property-group" data-contexts="text">
        <label>Text Color</label>
        <input id="textColor" type="color" value="#000000">
    </div>

    <div class="property-group" data-contexts="text">
        <label>Text Style</label>
        <div class="property-input-row">
            <button id="textBold" type="button" class="pill-btn">B</button>
            <button id="textItalic" type="button" class="pill-btn">I</button>
            <button id="textFontDecrease" type="button" class="pill-btn">Aâˆ’</button>
            <button id="textFontIncrease" type="button" class="pill-btn">A+</button>
        </div>
    </div>

    <div class="property-group" data-contexts="wall">
        <label>Measurements</label>
        <div class="property-input-row">
            <button id="measurementFontDecrease" type="button" class="pill-btn">Aâˆ’</button>
            <button id="measurementFontIncrease" type="button" class="pill-btn">A+</button>
        </div>
    </div>

    <div class="property-group" data-contexts="floor">
        <label>Fill</label>
        <div class="property-input-row">
            <input id="fillColor" type="color" value="#d9d9d9">
            <span id="fillColorPreview"></span>
        </div>
    </div>

    <div class="property-group" data-contexts="wall,door,window,staircase,furniture,floor,dimension,select,erase,pan">
        <label>Grid Size</label>
        <input id="gridSize" type="number" value="20">
    </div>

    <div class="property-group inline" data-contexts="wall,door,window,staircase,furniture,floor,dimension,select,erase,pan">
        <label class="checkbox"><input type="checkbox" id="snapToGrid" checked> Snap to Grid</label>
        <label class="checkbox"><input type="checkbox" id="showDimensions" checked> Show Dimensions</label>
    </div>

    <div class="property-group button-row" data-contexts="wall,door,window,staircase,furniture,floor,dimension,select,erase,pan">
        <button id="toggleGrid">Toggle Grid</button>
        <button id="toggleBackgroundImage" class="hidden">Hide Background Image</button>
    </div>
</div>

<div class="canvas-shell">
    <div class="canvas-container">
        <canvas id="drawingCanvas" width="1800" height="1200"></canvas>
        <div id="threeContainer" class="three-container hidden"></div>
        <div id="threeStatus" class="three-status hidden" role="status" aria-live="polite"></div>
    </div>
</div>

<div class="coordinates">X: 0, Y: 0</div>

</div>

<div id="textModal" class="modal hidden">
    <div class="modal-content">
        <h3>Enter Text</h3>
        <input id="textModalInput" type="text" value="New label" aria-label="Enter text" />
        <div class="modal-actions">
            <button id="textModalConfirm" class="tool-btn" type="button">Add Text</button>
            <button id="textModalCancel" class="tool-btn secondary-btn" type="button">Cancel</button>
        </div>
    </div>
</div>

<div id="staircaseModal" class="modal hidden">
    <div class="modal-content">
        <h3>Staircase Settings</h3>
        <p class="modal-subtitle">Choose a layout and size before placing the staircase on the plan.</p>

        <label class="modal-label" for="staircaseLayout">Layout</label>
        <select id="staircaseLayout">
            <option value="straight">Straight run</option>
            <option value="landing">Straight with landing</option>
            <option value="l-shape">L shape</option>
            <option value="u-shape">U shape</option>
        </select>

        <div class="modal-grid">
            <div>
                <label class="modal-label">Stair width</label>
                <div class="modal-input-row">
                    <input type="number" id="staircaseWidthFeet" min="1" value="3.5"> ft
                </div>
            </div>
            <div>
                <label class="modal-label">Riser height</label>
                <div class="modal-input-row">
                    <input type="number" id="staircaseRiseInches" min="4" max="9" value="7"> in
                </div>
            </div>
        </div>

        <div class="modal-grid">
            <div>
                <label class="modal-label" for="staircaseSteps">Number of steps</label>
                <div class="modal-input-row">
                    <input type="number" id="staircaseSteps" min="3" value="10">
                </div>
            </div>
            <div>
                <label class="modal-label" for="staircaseLandingDepth">Landing depth</label>
                <div class="modal-input-row">
                    <input type="number" id="staircaseLandingDepth" min="2" value="3"> ft
                </div>
            </div>
        </div>

        <div class="staircase-summary" id="staircaseSummary"></div>

        <div class="modal-actions">
            <button id="staircaseApply" class="tool-btn" type="button">Apply</button>
            <button id="staircaseCancel" class="tool-btn secondary-btn" type="button">Cancel</button>
        </div>
    </div>
</div>

<div id="floorTextureModal" class="modal hidden">
    <div class="modal-content">
        <h3>Floor Texture</h3>
        <p class="modal-subtitle">Upload a custom tile and set its real dimensions to control how it repeats.</p>
        <label class="modal-label" for="floorTextureFile">Texture image</label>
        <input type="file" id="floorTextureFile" accept="image/*">

        <div class="modal-grid">
            <div>
                <label class="modal-label">Width</label>
                <div class="modal-input-row">
                    <input type="number" id="textureWidthFeet" min="0" value="1"> ft
                    <input type="number" id="textureWidthInches" min="0" max="11" value="0"> in
                </div>
            </div>
            <div>
                <label class="modal-label">Length</label>
                <div class="modal-input-row">
                    <input type="number" id="textureHeightFeet" min="0" value="1"> ft
                    <input type="number" id="textureHeightInches" min="0" max="11" value="0"> in
                </div>
            </div>
        </div>

        <div class="modal-actions">
            <button id="applyFloorTexture" class="tool-btn">Apply</button>
            <button id="cancelFloorTexture" class="tool-btn secondary-btn" type="button">Cancel</button>
        </div>
    </div>
</div>

<div id="backgroundImageModal" class="modal hidden">
    <div class="modal-content wide">
        <h3>Add Background Image</h3>
        <p class="modal-subtitle">Upload a reference floor plan to trace over. Only image files are supported.</p>

        <label class="modal-label" for="backgroundImageFile">Image file</label>
        <input type="file" id="backgroundImageFile" accept="image/*">

        <div class="preview-row">
            <div class="preview-box">
                <p class="modal-subtitle">Preview</p>
                <div class="preview-frame">
                    <img id="backgroundPreview" alt="Background preview" />
                    <canvas id="backgroundPreviewCanvas" class="preview-measure-canvas"></canvas>
                    <div id="backgroundPreviewPlaceholder">Upload an image to preview it here.</div>
                </div>
            </div>
            <div class="measurement-box">
                <p class="modal-subtitle">Measurement</p>
                <label class="modal-label" for="backgroundDistance">Known distance (ft)</label>
                <input type="text" id="backgroundDistance" inputmode="decimal" placeholder="Enter distance">
                <p class="modal-subtitle small">You will place this distance on the image in the next step.</p>
            </div>
        </div>

        <div class="modal-actions">
            <button id="startBackgroundMeasurement" class="tool-btn" type="button" disabled>Next</button>
            <button id="finishBackgroundMeasurement" class="tool-btn secondary-btn" type="button" disabled>Finish</button>
            <button id="cancelBackgroundImage" class="tool-btn secondary-btn" type="button">Cancel</button>
        </div>

        <div id="backgroundMeasurementHint" class="measurement-hint hidden">
            Drag the measurement line on the canvas to match the known distance, then press Finish.
        </div>
    </div>
</div>

<div id="backgroundCalibrationBar" class="calibration-bar hidden">
    <div>
        <strong>Background calibration:</strong>
        <span id="backgroundCalibrationText">Drag the measurement line to match the real distance.</span>
    </div>
    <div class="calibration-actions">
        <button id="cancelBackgroundMeasurement" class="tool-btn secondary-btn" type="button">Cancel</button>
    </div>
</div>

<script src="transformTools.js"></script>
<script src="script.js"></script>
<script src="doorTools.js"></script>
<script src="windowTools.js"></script>
<script src="panTools.js"></script>
<script src="dimensionTools.js"></script>

</body>
</html>
